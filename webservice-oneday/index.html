<!doctype html><html lang=en><head><meta charset=utf-8><title>1日でわかるWebサービス制作の全て ～企画から実装まで～</title><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><link rel=canonical href=https://yusukebe.github.io/slides/webservice-oneday/><meta property="og:title" content="1日でわかるWebサービス制作の全て ～企画から実装まで～ &ndash; yusukebe/slides"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://yusukebe.github.io/slides/webservice-oneday/"><meta property="og:site_name" content="yusukebe/slides"><meta name=twitter:card content="summary_large_image"><meta name=twitter:domain content="yusukebe.github.com"><meta name=twitter:title content="1日でわかるWebサービス制作の全て ～企画から実装まで～ &ndash; yusukebe/slides"><meta name=twitter:description content><link rel=stylesheet href=/slides/reveal-js/css/reset.css><link rel=stylesheet href=/slides/reveal-js/css/reveal.css><link rel=stylesheet href=/slides/_.min.987502fe84ada46c1007ceba381f024831c3f8a91da4d3557a6728583666d6aa.css id=theme><link rel=stylesheet href=/slides/highlight-js/default.min.css></head><body><div class=reveal><div class=slides><section><h1 id=1日でわかるwebサービス制作の全て-企画から実装まで>1日でわかるWebサービス制作の全て ～企画から実装まで～</h1><p><a href=http://event.shoeisha.jp/mza/20130723>MarkeZine Academy 2013/07/23</a></p><p>by <a href=http://yusukebe.com/>Yusuke Wada a.k.a yusukebe</a></p></section><section><h2 id=イントロダクション>イントロダクション</h2></section><section><h3 id=自己紹介>自己紹介</h3><ul><li>和田裕介 / Yusuke Wada</li><li>1981年生</li><li>(株) ワディット代表取締役</li><li>(株) オモロキ取締役兼最高技術責任者</li><li>Web Application Developer</li><li>物書きも少々</li></ul></section><section><h3 id=ワディット>ワディット</h3><p><img src=images/wadit.jpg alt=ワディット></p></section><section><h3 id=オモロキ>オモロキ</h3></section><section><h3 id=メインワークその1>メインワークその1</h3><p><img src=images/bokete.png alt=ボケて></p></section><section><h3 id=メインワークその2>メインワークその2</h3><p><img src=images/book.jpg alt=Webサービスのつくり方></p></section><section><h3 id=その他つくったモノ>その他つくったモノ</h3><ul><li><a href=http://kimi.la/>君のラジオ</a></li><li>anpiレポート</li><li>CDTube</li></ul></section><section><h3 id=君のラジオhttpkimila><a href=http://kimi.la/>君のラジオ</a></h3><p><img src=images/kimi.png alt=君のラジオ></p></section><section><h3 id=anpiレポート>anpiレポート</h3><p><img src=images/anpi.png alt=anpiレポート></p></section><section><h3 id=cdtube>CDTube</h3><p><img src=images/cdtube.jpg alt=CDTube></p></section><section><h2 id=ボケてbokete>ボケて（bokete）</h2></section><section><h3 id=現状>現状</h3><ul><li>全デバイス合計 月間「1億PV以上」</li><li>スマホアプリ合計 170万ダウンロード</li><li>hao123、 Yahoo! JAPANと連携</li><li>コンテンツ書籍化 x 2回</li><li>各種企業様とコラボ</li></ul></section><section><h3 id=歩み>歩み</h3><p><img src=images/bokete_history.png alt=ボケての歩み></p></section><section><h2 id=本題webサービスをつくるに当たって>本題「Webサービスをつくるに当たって」</h2></section><section><h3 id=webサービスの定義>Webサービスの定義</h3><p>訪問者に対して何かしらの <em>サービス</em> を提供するWeb</p><ul><li>HTTPを応用してSOAP/XMLなどを使ったメッセージ送受信することもWebサービスと呼ばれる</li><li>動的なWebサイト</li><li>アクセスされた状況に応じてページが変化する</li><li>連動するスマホアプリもその一環</li></ul></section><section><h3 id=事例紹介クックパッド>事例紹介「クックパッド」</h3><p><img src=images/cookpad.png alt=クックパッド></p></section><section><h3 id=事例紹介nanapi>事例紹介「nanapi」</h3><p><img src=images/nanapi.png alt=クックパッド></p></section><section><h3 id=サービスを提供するユーザーがいる>サービスを提供する＝ユーザーがいる</h3><ul><li>いわゆる「B to C」の「C」</li><li>より多くのユーザーに使ってもらうこと</li><li>ユーザーの体験を充実させること</li><li>この2つが指標になる</li></ul></section><section><h3 id=個人や小さな規模からも始められる>個人や小さな規模からも始められる</h3><ul><li>オモロキの社員は4人</li><li>その他パートナーと組んで開発・運用</li><li>イニシャルコストが低い</li><li>個人でもWebサービスをつくって認知させることは可能</li><li>興味が多様化しているのでニッチなモノでも成り立つ</li></ul></section><section><h3 id=得られること>得られること</h3><ol><li>勉強になる</li><li>2枚目の名刺として</li><li>ユーザーの反応が楽しい</li><li>もしかしてお金になるかも…</li></ol></section><section><h3 id=嬉しい瞬間>嬉しい瞬間</h3><blockquote><p>「あのサービスをつくったゆーすけべーさんですよね？」</p></blockquote></section><section><h3 id=6畳一間から世界を変える>6畳一間から世界を変える</h3><p><img src=images/desk.jpg alt=デスク></p></section><section><h3 id=肝に銘じたい言葉>肝に銘じたい言葉</h3><blockquote><p>Shut the fuck up and write some code.</p></blockquote></section><section><h3 id=例えば>例えば…</h3><ul><li>Twitter上から「おはよう」が含まれるツイートを解析</li><li>アイデアの元</li><li>簡単なプログラムを動かすことで検証が出来る</li></ul></section><section><h3 id=twitter_searchpl>twitter_search.pl</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#66d9ef>use</span> Net::Twitter::Lite::WithAPIv1_1;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Config::Pit;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Encode;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> utf8;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>binmode STDOUT, <span style=color:#e6db74>&#39;:utf8&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>my</span> $config <span style=color:#f92672>=</span> pit_get(<span style=color:#e6db74>&#39;twitter-api&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>my</span> $nt	 <span style=color:#f92672>=</span> Net::Twitter::Lite::WithAPIv1_1<span style=color:#f92672>-&gt;</span><span style=color:#66d9ef>new</span>(
</span></span><span style=display:flex><span>	consumer_key		<span style=color:#f92672>=&gt;</span> $config<span style=color:#f92672>-&gt;</span>{consumer_key},
</span></span><span style=display:flex><span>	consumer_secret	 <span style=color:#f92672>=&gt;</span> $config<span style=color:#f92672>-&gt;</span>{consumer_secret},
</span></span><span style=display:flex><span>	access_token		<span style=color:#f92672>=&gt;</span> $config<span style=color:#f92672>-&gt;</span>{token},
</span></span><span style=display:flex><span>	access_token_secret <span style=color:#f92672>=&gt;</span> $config<span style=color:#f92672>-&gt;</span>{token_secret}
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>my</span> $result <span style=color:#f92672>=</span> $nt<span style=color:#f92672>-&gt;</span>search(
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#e6db74>q		</span>		<span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;おはよう&#39;</span>,
</span></span><span style=display:flex><span>		include_entities <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>		result_type	  <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;recent&#39;</span>,
</span></span><span style=display:flex><span>		count			<span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#66d9ef>my</span> $tweet ( @{ $result<span style=color:#f92672>-&gt;</span>{statuses} } ) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;$tweet-&gt;{text}\n&#34;</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>print</span> <span style=color:#e6db74>&#34;----------------------------------------\n&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=とにかく手を動かすことが大事>とにかく手を動かすことが大事</h3><blockquote><p>そこに1,000人いたとして、アイデアを思いつくのが100人、アイデアを実現するのが10人、アイデアで成功する人は1人</p></blockquote></section><section><h2 id=企画と開発準備>企画と開発準備</h2></section><section><h3 id=つくり方をつくる>つくり方をつくる</h3><ul><li>モノをつくるための方法を自分なりにつくる</li><li>参考になる本<ul><li><a href=http://www.amazon.co.jp/dp/415208426X/>IDEO 「発想する会社」</a></li><li><a href=http://www.amazon.co.jp/dp/4152087994/>デザイン思考の道具箱</a></li><li><a href=http://www.amazon.co.jp/dp/4396612117/>仕事のやり方間違えています</a></li><li><a href=http://www.amazon.co.jp/dp/4484881047/>アイデアのつくり方</a></li></ul></li></ul></section><section><h3 id=デザイン思考の道具箱>デザイン思考の道具箱</h3><p><img src=images/okudehon.jpg alt=デザイン思考の道具箱></p></section><section><h3 id=創造のサイクルを回せ>創造のサイクルを回せ</h3><p><img src=images/cycle.jpg alt=創造のサイクル></p></section><section><pre tabindex=0><code>1. 哲学
  - 個々人が持つある興味に対する揺るがない信念
2. アイデア
  - 哲学を叶える個別具体的なアイデア
3. テーマ
  - 勝負する領域
4. コンセプト
  - アイデアを束ねるつくるモノを一言で表すような枠組み
5. 名前
  - これが無くては始まらない。キラキラネームかセルフトーキングか
6. デザイン
  - 見た目のみならず、ディテールを妥協して決めていく作業
7. 内部設計
  - 実装に向けてのシステムの内側を設計する
</code></pre></section><section><h3 id=例えば-1>例えば…</h3><p><a href=http://cookpad.com/>クックパッド</a> の場合…</p></section><section><h3 id=アイデアとコンセプトの違い>アイデアとコンセプトの違い</h3><ul><li>アイデアはいくつも出てくる</li><li>それをまとめるフレームワークみたいなのがコンセプト</li></ul><blockquote><p>例: ボケては「写真で一言ボケる」Webサービス</p></blockquote></section><section><h3 id=アイデアは組み合わせ>アイデアは組み合わせ</h3><blockquote><p>アイデアとは既存の要素の新しい組み合わせ以外の何のものでもないということである</p></blockquote><blockquote><p>「アイデアのつくり方」より</p></blockquote></section><section><h3 id=シャワーを浴びている時に降ってくる>シャワーを浴びている時に降ってくる</h3><ul><li>アイデアはすぐに出てくるものでは無い</li><li>孵化する直前までいかに追い込むかが重要</li><li>その後はリラックスしていると不思議と出てくる</li></ul></section><section><h3 id=シーズとニーズの話>シーズとニーズの話</h3><ul><li>これが出来るという「シーズ」</li><li>これが欲しいという「ニーズ」</li><li>どちらも知っている必要はある</li><li>が、偏ってもいけない</li></ul></section><section><h3 id=究極のブレインストーミング>究極のブレインストーミング</h3><p><img src=images/ideo.jpg alt=IDEO></p><p><a href=http://www.designsojourn.com/7-ways-to-unleashing-your-creativity/>7 Ways to Unleashing your Creativity</a> より</p></section><section><h3 id=ブレストにはルールがある>ブレストにはルールがある</h3><ul><li>否定をしない</li><li>むしろ乗っかかる</li><li>時間を決める</li><li>数を数える</li><li>突飛なことを言う</li><li>まとめる役割</li></ul></section><section><h3 id=リスクリスクリスク>リスク、リスク、リスク</h3><blockquote><p>そにはリスクが潜んでいる</p></blockquote><p><img src=images/typhoon.jpg alt=台風></p></section><section><ul><li>スキルリスク</li><li>技術リスク</li><li>政治リスク</li><li>法的リスク</li></ul></section><section><h3 id=ユースケースによる要求定義>ユースケースによる要求定義</h3><p><img src=images/use_case.png alt=ユースケース図></p></section><section><h3 id=開発の準備をしよう>開発の準備をしよう</h3><p>「企画倒れ」にならないよう開発へのハードルを下げていく</p><blockquote><p>やるやる詐欺にはなりたくない</p></blockquote></section><section><h3 id=エディタという道具>エディタという道具</h3><blockquote><p>これはemacsです！</p></blockquote><p><img src=images/emacs.png alt=emacs></p></section><section><h3 id=勉強会>勉強会</h3><p><img src=images/perl_entrance.jpg alt=Perl入学式></p></section><section><h3 id=巨人の肩に乗る>巨人の肩に乗る</h3><blockquote><p>Standing on the shoulders of giants</p></blockquote><p>CPANライブラリのエコシステム</p><ul><li><a href=http://yusukebe.com/archives/20090912/120113.html>Where are Casual Perlers ?</a></li><li><a href=http://bulknews.typepad.com/blog/2009/09/on-module-writers-and-users.html>On module writers and users</a></li></ul></section><section><h2 id=webテクノロジーオーバービュー>Webテクノロジー・オーバービュー</h2></section><section><h3 id=webの基礎技術を学びながらつくる>Webの基礎技術を学びながらつくる</h3><p>オススメ本</p><p><img src=images/http_and_rest_hon.jpg alt=Webを支える技術></p></section><section><h3 id=ホームページをブラウザで閲覧する際の裏側>ホームページをブラウザで閲覧する際の裏側</h3><p><img src=images/client_server.png alt=サーバ・クライアント></p><p>このやり取り自体が取り決め＝ <em>プロトコル</em> として定められている</p></section><section><h3 id=httpurihtml>HTTP、URI、HTML</h3><p><img src=images/web_diagram.png alt=HTTP、URI、HTML></p><blockquote><p>あくまで取り決めなので「そういうモノ」として捉える</p></blockquote></section><section><h3 id=uri--url>URI / URL</h3><blockquote><p><a href=http://example.com/about.html>http://example.com/about.html</a></p></blockquote><ul><li>プロトコルに「HTTP」を使用する</li><li>ホスト名は example.com</li><li>パスが /about.html</li><li>拡張子が.htmlなので大抵HTMLである</li></ul></section><section><h3 id=httpのメソッド>HTTPのメソッド</h3><p>クライアントからサーバへのリクエスト。リソースを扱うため、主に4つが使われている</p><ul><li>GET</li><li>POST</li><li>PUT</li><li>DELETE</li></ul></section><section><h3 id=telnetでget>telnetでGET</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>$ telnet yusukebe.com <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>GET / HTTP/1.1
</span></span><span style=display:flex><span>Host: yusukebe.com
</span></span></code></pre></div></section><section><h3 id=webページを構成する要素>Webページを構成する要素</h3><ul><li>HTML</li><li>CSS</li><li>JavaScript</li><li>画像、Flashなどのバイナリファイル</li></ul></section><section><h3 id=html---hypertext-markup-language>HTML - HyperText Markup Language</h3><p>ある程度構造化したテキストをマークアップで書ける</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>&lt;<span style=color:#f92672>h2</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;title&#34;</span>&gt;タイトル&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span></code></pre></div></section><section><h3 id=css---cascading-style-sheets>CSS - Cascading Style Sheets</h3><p>CSSセレクタを利用しHTMLを装飾する</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#f92672>h2</span>.<span style=color:#a6e22e>title</span> { <span style=color:#66d9ef>color</span>:<span style=color:#ae81ff>#333</span>; }
</span></span></code></pre></div></section><section><h3 id=javascript>JavaScript</h3><p>ページ自体をブラウザ側で操作し動きを与える</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;h2.title&#39;</span>).<span style=color:#a6e22e>fadeOut</span>();
</span></span></code></pre></div></section><section><h3 id=動的サイトと静的サイト>動的サイトと静的サイト</h3><p><img src=images/static_or_dynamic.png alt=静的サイトと動的サイト></p></section><section><h3 id=webプログラミング言語>Webプログラミング言語</h3><ul><li>PHP</li><li>Perl</li><li>Ruby</li><li>Python</li><li>Java</li></ul><p>などが主流であるが C言語 でも不可能ではない</p></section><section><h3 id=web-application-framework>Web Application Framework</h3><blockquote><p>例えば、Ruby on Rails</p></blockquote></section><section><h3 id=それ以前>それ以前</h3><p><img src=images/kent.png alt=CGI></p></section><section><h3 id=mvcモデル>MVCモデル</h3><ul><li>Model</li><li>View</li><li>Controller</li></ul><blockquote><p>役割を分離して考えておくとよいよねぇ〜</p></blockquote></section><section><h3 id=webサーバミドルウェア色々>Webサーバ、ミドルウェア色々</h3><ul><li>Apache</li><li>nginx</li><li>MySQL</li><li>memcached</li><li>Redis</li><li>MongoDB</li></ul></section><section><h3 id=クラウドとしてのaws>クラウドとしてのAWS</h3><ul><li>Amazon Web Services</li><li>ボケてでは現在30台ほどのサーバを利用</li><li>10分でスケールアウトすることが可能</li><li>マネージドされたミドルウェアを使える<ul><li>S3 / CloudFront</li><li>RDS</li><li>ElastiCache</li><li>SES</li></ul></li></ul></section><section><h2 id=ライブコーディングその1>ライブコーディングその1</h2></section><section><h3 id=なんかつくります>なんかつくります！</h3><blockquote><p>例: Twitterログイン掲示板</p></blockquote></section><section><h3 id=いつつくるの>いつつくるの？</h3><blockquote><p>今でしょ！</p></blockquote></section><section><h2 id=開発の実際>開発の実際</h2></section><section><h3 id=3種の神器>3種の神器</h3><ul><li>ターミナル</li><li>エディタ</li><li>ブラウザ</li></ul></section><section><h3 id=レポジトリとしてのgit>レポジトリとしてのGit</h3><ul><li>コードのバージョン管理システム</li><li>clone/commit/push/pull/merge</li></ul></section><section><h3 id=github>GitHub</h3><p><img src=images/github.png alt=GitHub></p></section><section><h3 id=流れ>流れ</h3><ol><li>コードを書く</li><li>テストを書く（最初に書くケースも）</li><li>実行する</li><li>ブラウザで確認する</li><li>commit/push</li></ol></section><section><h3 id=デプロイ>デプロイ</h3><ul><li>手元のOSX = 開発環境</li><li>テスト/ステージング/本番</li><li>デプロイツールで自動化</li></ul></section><section><h2 id=開発言語的な>開発言語的な&mldr;</h2></section><section><h3 id=use-perl>use Perl</h3><ul><li>25歳/ラリー・ウォールさんによる</li><li>テキスト処理に強い言語</li><li>Ruby/Python/PHPに押されがちだけど…</li><li>Webもテキストみたい ＝ Webにも強い</li><li>Perl5の最新安定バージョンは 5.18.0</li></ul></section><section><h3 id=tmtowtdi>TMTOWTDI</h3><p><img src=images/larry.jpg alt=ラリー・ウォール></p><blockquote><p>やり方はひとつじゃない</p></blockquote></section><section><h3 id=実はこの資料もperlでhtml化>実はこの資料もPerlでHTML化!!!</h3><ul><li>Markdown でテキストを編集</li><li>手元にてリアルタイムでプレビューするWebアプリ</li><li>変換スクリプトでHTML化</li><li>GitHub Pagesで公開</li><li><a href=lib/WebServiceOneDay.pm>WebServiceOneDay.pm</a></li><li><a href=examples/convert.pl>convert.pl</a></li></ul></section><section><h3 id=cpanライブラリ>CPANライブラリ</h3><p><img src=images/cpan.png alt=search.cpan.org></p></section><section><h3 id=webserviceonedaypm>WebServiceOneDay.pm</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#66d9ef>package</span> WebServiceOneDay;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> strict;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> warnings;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Text::Markdown <span style=color:#e6db74>qw/markdown/</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Path::Class <span style=color:#e6db74>qw/file/</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Encode <span style=color:#e6db74>qw/decode_utf8/</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Data::Section::Simple <span style=color:#e6db74>qw/get_data_section/</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Text::MicroTemplate <span style=color:#e6db74>qw/render_mt/</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>…</span>;
</span></span></code></pre></div></section><section><h3 id=perl-mongers->Perl Mongers !!</h3><p><img src=images/yapcasia.jpg alt="YAPC::Asia 2011"></p></section><section><h2 id=web-application-framework-1>Web Application Framework</h2></section><section><h3 id=mojolicious>Mojolicious</h3><ul><li>MVCのうちVCをサポート</li><li>Perlコアモジュールのみに依存 = ポータブル</li><li>いわゆるフルスタックではない</li><li>自前で最小限全てを実装している意味ではフルスタック</li><li>その他CPANモジュールを組み合わせる</li><li>最新バージョンは 4.18</li></ul></section><section><h3 id=スケルトン>スケルトン</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>$ mojo generate app MyApp::Web
</span></span></code></pre></div><p>すると…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>	$ tree ./
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	./
</span></span><span style=display:flex><span>	├── lib
</span></span><span style=display:flex><span>	│   └── MyApp
</span></span><span style=display:flex><span>	│  	 ├── Web
</span></span><span style=display:flex><span>	│  	 │   └── Example.pm
</span></span><span style=display:flex><span>	│  	 └── Web.pm
</span></span><span style=display:flex><span>	├── log
</span></span><span style=display:flex><span>	├── public
</span></span><span style=display:flex><span>	│   └── index.html
</span></span><span style=display:flex><span>	├── script
</span></span><span style=display:flex><span>	│   └── my_app_web
</span></span><span style=display:flex><span>	├── t
</span></span><span style=display:flex><span>	│   └── basic.t
</span></span><span style=display:flex><span>	└── templates
</span></span><span style=display:flex><span>		├── example
</span></span><span style=display:flex><span>		│   └── welcome.html.ep
</span></span><span style=display:flex><span>		└── layouts
</span></span><span style=display:flex><span>			└── default.html.ep
</span></span></code></pre></div></section><section><h3 id=ルーティング>ルーティング</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#66d9ef>package</span> MyApp::Web;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Mojo::Base <span style=color:#e6db74>&#39;Mojolicious&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>startup</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>my</span> $self <span style=color:#f92672>=</span> shift;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>my</span> $r <span style=color:#f92672>=</span> $self<span style=color:#f92672>-&gt;</span>routes;
</span></span><span style=display:flex><span>	$r<span style=color:#f92672>-&gt;</span>namespaces([<span style=color:#e6db74>&#39;MyApp::Web::Controller&#39;</span>]);
</span></span><span style=display:flex><span>	$r<span style=color:#f92672>-&gt;</span>get(<span style=color:#e6db74>&#39;/&#39;</span>)<span style=color:#f92672>-&gt;</span>to(<span style=color:#e6db74>&#39;root#index&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>;
</span></span></code></pre></div></section><section><h3 id=コントローラ>コントローラ</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#66d9ef>package</span> MyApp::Web::Controller::Root;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> Mojo::Base <span style=color:#e6db74>&#39;Mojolicious::Controller&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>index</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>my</span> $self <span style=color:#f92672>=</span> shift;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>my</span> $message <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Hello, I&#39;m from Yokohama!&#34;</span>;
</span></span><span style=display:flex><span>	$self<span style=color:#f92672>-&gt;</span>stash<span style=color:#f92672>-&gt;</span>{message} <span style=color:#f92672>=</span> $message;
</span></span><span style=display:flex><span>	$self<span style=color:#f92672>-&gt;</span>render();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>;
</span></span></code></pre></div></section><section><h3 id=テンプレート>テンプレート</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>% layout &#39;default&#39;;
</span></span><span style=display:flex><span>% title &#39;Welcome&#39;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>h2</span>&gt;<span style=color:#960050;background-color:#1e0010>&lt;</span>%= $message %&gt;&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span></code></pre></div></section><section><h3 id=さて>さて</h3><blockquote><p>なにをつくりましょうか！</p></blockquote></section><section><h2 id=ライブコーディングその2>ライブコーディングその2</h2></section><section><h3 id=データベースを扱う>データベースを扱う</h3><ul><li>MySQLを使用</li><li>リレーショナルデータベースの一種</li><li>いわゆる「表」</li><li>SQLによる問い合わせ</li><li>データの抽出、結合</li></ul></section><section><h3 id=テーブル構造>テーブル構造</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>mysql&gt; <span style=color:#66d9ef>select</span> * from entry;
</span></span><span style=display:flex><span>+----+---------------+-----------+---------+---------------------+
</span></span><span style=display:flex><span>| id | title		 | body	  | user_id | created_on		  |
</span></span><span style=display:flex><span>+----+---------------+-----------+---------+---------------------+
</span></span><span style=display:flex><span>|  <span style=color:#ae81ff>1</span> | This is title | Body Text |	   <span style=color:#ae81ff>1</span> | 2013-07-23 14:00:00 |
</span></span><span style=display:flex><span>+----+---------------+-----------+---------+---------------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> row in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span></code></pre></div></section><section><h3 id=sql文>SQL文</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> entry (
</span></span><span style=display:flex><span>	id INT UNSIGNED AUTO_INCREMENT,
</span></span><span style=display:flex><span>	title VARCHAR(<span style=color:#ae81ff>255</span>),
</span></span><span style=display:flex><span>	body TEXT <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>	user_id BIGINT UNSIGNED <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>	created_on DATETIME <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (<span style=color:#f92672>`</span>id<span style=color:#f92672>`</span>)
</span></span><span style=display:flex><span>) <span style=color:#66d9ef>DEFAULT</span> CHARACTER <span style=color:#66d9ef>SET</span> <span style=color:#e6db74>&#39;utf8&#39;</span> engine<span style=color:#f92672>=</span>InnoDB;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> entry
</span></span><span style=display:flex><span>(title, body, user_id, created_on)
</span></span><span style=display:flex><span><span style=color:#66d9ef>VALUES</span>
</span></span><span style=display:flex><span>(<span style=color:#e6db74>&#39;This is title&#39;</span>, <span style=color:#e6db74>&#39;Body Text&#39;</span>, <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;2013-07-23 14:00:00&#39;</span>);
</span></span></code></pre></div></section><section><h3 id=or-mapper>O/R Mapper</h3><ul><li>Object-relational mapping</li><li>Rowオブジェクトとして扱う</li><li>リレーションも面倒を見る？</li><li>よりプログラムっぽくSQL発行</li></ul></section><section><h3 id=疑似コード>疑似コード</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>$db<span style=color:#f92672>-&gt;</span>insert( <span style=color:#e6db74>&#39;entry&#39;</span>,
</span></span><span style=display:flex><span>		{ title <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;This is title&#39;</span>, body <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Body text&#39;</span> } );
</span></span><span style=display:flex><span><span style=color:#66d9ef>my</span> $entry <span style=color:#f92672>=</span> $db<span style=color:#f92672>-&gt;</span>single( <span style=color:#e6db74>&#39;entry&#39;</span>, { id <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span> } );
</span></span><span style=display:flex><span>say $entry<span style=color:#f92672>-&gt;</span>title; <span style=color:#75715e># This is title</span>
</span></span><span style=display:flex><span>$entry<span style=color:#f92672>-&gt;</span>update({ title <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Another title&#39;</span> });
</span></span><span style=display:flex><span>say $entry<span style=color:#f92672>-&gt;</span>title; <span style=color:#75715e># Another title</span>
</span></span><span style=display:flex><span>$entry<span style=color:#f92672>-&gt;</span>delete();
</span></span></code></pre></div></section><section><h3 id=モデルをつくってコントローラから呼び出す>モデルをつくってコントローラから呼び出す</h3><ul><li>極力コントローラは薄く</li><li>モデル単体で動作、テスト可能なように</li><li>モデル内でO/R Mapperを扱うことを推奨</li></ul></section><section><h3 id=コントローラにて>コントローラにて</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span><span style=color:#66d9ef>sub</span> <span style=color:#a6e22e>index</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>my</span> $self <span style=color:#f92672>=</span> shift;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>my</span> $entries <span style=color:#f92672>=</span> $self<span style=color:#f92672>-&gt;</span>model(<span style=color:#e6db74>&#39;Entry&#39;</span>)<span style=color:#f92672>-&gt;</span>get_recent_entries({}, {
</span></span><span style=display:flex><span>		order_by <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;id DESC&#39;</span>, page <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>	$self<span style=color:#f92672>-&gt;</span>stash<span style=color:#f92672>-&gt;</span>{entries} <span style=color:#f92672>=</span> $entries;
</span></span><span style=display:flex><span>	$self<span style=color:#f92672>-&gt;</span>render(<span style=color:#e6db74>&#39;index&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></section><section><h3 id=cli>CLI</h3><ul><li>コマンドラインインターフェース</li><li>cron や デーモンとして実行する</li><li>いわゆるバッチ処理</li><li>ジョブキュー</li><li>vs Webアプリ</li></ul></section><section><h3 id=バリデーション>バリデーション</h3><ul><li>フォームの入力値の検証</li><li>例えば、それが郵便番号っぽいか？</li><li>適切なエラーメッセージを表示してあげる</li></ul></section><section><h3 id=フロントエンドを実装する>フロントエンドを実装する</h3><ul><li>最小限のライブラリで楽をする</li><li>jQuery</li><li>CSS Framework</li></ul></section><section><h3 id=テスト>テスト</h3><ul><li>プログラムが望む挙動をしているか？を担保する</li><li>テストコードが自動で「緑」か「赤」かを判断</li></ul><p>TAP</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=nohighlight data-noescape><span style=display:flex><span>ok $model<span style=color:#f92672>-&gt;</span>get_entry({ id <span style=color:#f92672>=&gt;</span> <span style=color:#ae81ff>1</span> });
</span></span></code></pre></div></section><section><h3 id=プロビジョニング例>プロビジョニング例</h3><ul><li>VPS もしくは AWS という選択肢</li><li>フロントエンド - nginx</li><li>アプリケーションサーバ - Starman / Starlet</li><li>DBサーバ - MySQL</li><li>キャッシュサーバ - memcached</li></ul></section><section><h2 id=今回紹介しなかったこと>今回紹介しなかったこと</h2></section><section><h3 id=セキュリティ>セキュリティ</h3><ul><li>Mojoliciousのセッション</li><li>エスケープ関係諸々</li><li>CSRF対策</li><li>サーバのセキュアな運営</li></ul></section><section><h3 id=デプロイの実践>デプロイの実践</h3><ul><li>サーバ設定</li><li>デプロイツール</li><li>監視</li></ul></section><section><h2 id=まとめ>まとめ</h2><ul><li>Webサービスをつくるための心得</li><li>企画と設計</li><li>Webのテクノロジー</li><li>実際につくってみた</li></ul></section></div></div><script type=text/javascript src=/slides/reveal-hugo/object-assign.js></script>
<a href=/slides/reveal-js/css/print/ id=print-location style=display:none></a>
<script type=text/javascript>var printLocationElement=document.getElementById("print-location"),link=document.createElement("link");link.rel="stylesheet",link.type="text/css",link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?"pdf.css":"paper.css"),document.getElementsByTagName("head")[0].appendChild(link)</script><script type=application/json id=reveal-hugo-site-params>{"custom_theme":"stylesheets/custom-theme.scss","custom_theme_compile":true}</script><script type=application/json id=reveal-hugo-page-params>null</script><script src=/slides/reveal-js/js/reveal.js></script>
<script type=text/javascript>function camelize(e){return e&&Object.keys(e).forEach(function(t){newK=t.replace(/(_\w)/g,function(e){return e[1].toUpperCase()}),newK!=t&&(e[newK]=e[t],delete e[t])}),e}var revealHugoDefaults={center:!0,controls:!0,history:!0,progress:!0,transition:"slide"},revealHugoSiteParams=JSON.parse(document.getElementById("reveal-hugo-site-params").innerHTML),revealHugoPageParams=JSON.parse(document.getElementById("reveal-hugo-page-params").innerHTML),options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams));Reveal.initialize(options)</script><script type=text/javascript src=/slides/reveal-js/plugin/markdown/marked.js></script>
<script type=text/javascript src=/slides/reveal-js/plugin/markdown/markdown.js></script>
<script type=text/javascript src=/slides/reveal-js/plugin/highlight/highlight.js></script>
<script type=text/javascript src=/slides/reveal-js/plugin/zoom-js/zoom.js></script>
<script type=text/javascript src=/slides/reveal-js/plugin/notes/notes.js></script></body></html>